FROM python:3.10-slim

# -------------------------------------------------
# System dependencies
# -------------------------------------------------


# -------------------------------------------------
# App directory
# -------------------------------------------------
WORKDIR /app

# -------------------------------------------------
# Copy backend code (NO nested dirs)
# -------------------------------------------------
COPY backend/ /app/

# Landmarks folder (if missing)
RUN mkdir -p /app/landmarks

# -------------------------------------------------
# Install Python deps
# -------------------------------------------------
RUN pip install --no-cache-dir --upgrade pip && \
    pip install --no-cache-dir -r requirements.txt

# -------------------------------------------------
# Auto-load .env
# -------------------------------------------------
ENV PYTHONUNBUFFERED=1

# -------------------------------------------------
# Run FastAPI
# -------------------------------------------------
CMD ["uvicorn", "main:app", "--host", "0.0.0.0", "--port", "8000"]
